<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>HustlerHer Social Suite</title>
  <meta name="description" content="Luxury micro-SaaS planner for business women managing social media marketing."/>
  <style>
    :root{
      --bg:#0b0f17;
      --card: rgba(255,255,255,.07);
      --txt:#f5f6fb;
      --muted:#b9bed0;
      --gold:#d4af37;
      --rose:#e7a7b6;
      --cream:#f7f1ea;
      --line: rgba(255,255,255,.14);
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --r: 22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(900px 600px at 15% 20%, rgba(231,167,182,.25), transparent 55%),
        radial-gradient(900px 600px at 90% 10%, rgba(212,175,55,.22), transparent 55%),
        radial-gradient(900px 600px at 70% 90%, rgba(120,180,255,.16), transparent 55%),
        linear-gradient(180deg, #070a10, #0b0f17 40%, #070a10);
      color: var(--txt);
      min-height:100vh;
    }
    a{color:inherit; text-decoration:none}
    .wrap{max-width:1120px; margin:0 auto; padding:22px}

    /* TOPBAR */
    .topbar{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(14px);
      background: rgba(7,10,16,.62);
      border-bottom:1px solid var(--line);
    }
    .topbar .inner{
      max-width:1120px; margin:0 auto;
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 22px;
      gap:12px;
    }
    .brand{
      display:flex; gap:10px; align-items:center;
      font-weight:900; letter-spacing:.2px;
      white-space:nowrap;
      cursor:pointer;
    }
    .badge{
      font-size:12px; padding:6px 10px;
      border:1px solid rgba(212,175,55,.45);
      border-radius:999px;
      color: var(--cream);
      background: rgba(212,175,55,.12);
    }
    .nav{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
      justify-content:flex-end;
    }
    .nav a{
      padding:10px 12px;
      border:1px solid transparent;
      border-radius:999px;
      color: var(--muted);
    }
    .nav a:hover{border-color: var(--line); color: var(--txt)}
    .nav a.active{
      border-color: rgba(212,175,55,.55);
      color: var(--txt);
      background: rgba(212,175,55,.10);
    }

    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      gap:10px;
      padding:12px 16px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--txt);
      box-shadow: 0 10px 24px rgba(0,0,0,.25);
      cursor:pointer;
      user-select:none;
      font-weight:750;
    }
    .btn:hover{transform: translateY(-1px)}
    .btn:active{transform: translateY(0)}
    .btn.primary{
      border-color: rgba(212,175,55,.70);
      background: linear-gradient(135deg, rgba(212,175,55,.25), rgba(231,167,182,.18));
    }
    .btn.rose{
      border-color: rgba(231,167,182,.65);
      background: rgba(231,167,182,.12);
    }
    .btn.dark{background: rgba(0,0,0,.30)}
    .btn.small{padding:8px 12px; font-size:13px}

    .grid{display:grid; gap:16px}
    .grid.two{grid-template-columns: repeat(2, minmax(0,1fr))}
    .grid.three{grid-template-columns: repeat(3, minmax(0,1fr))}
    @media (max-width: 980px){ .grid.two,.grid.three{grid-template-columns:1fr} }

    .card{
      background: var(--card);
      border:1px solid var(--line);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .pad{padding:18px}
    .card h3{margin:0 0 8px; font-size:18px}
    .muted{color:var(--muted)}
    .tiny{font-size:12px; color: var(--muted)}
    .hr{height:1px; background: var(--line); margin:12px 0}

    .hero{
      padding:34px 0 18px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
      align-items:stretch;
    }
    @media (max-width: 980px){ .hero{grid-template-columns:1fr} }

    .heroTitle{
      font-size:44px; line-height:1.02;
      margin:0 0 12px;
      letter-spacing:-.8px;
    }
    .heroTitle span{
      background: linear-gradient(90deg, var(--gold), var(--rose), #ffffff);
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
    }
    .heroP{margin:0 0 18px; color: var(--muted); font-size:16px; max-width:56ch}
    .heroActions{display:flex; gap:12px; flex-wrap:wrap}

    .heroArt{
      position:relative;
      min-height: 290px;
      background:
        radial-gradient(200px 200px at 20% 30%, rgba(212,175,55,.30), transparent 60%),
        radial-gradient(260px 220px at 70% 35%, rgba(231,167,182,.26), transparent 60%),
        radial-gradient(260px 220px at 50% 85%, rgba(120,180,255,.18), transparent 60%),
        rgba(255,255,255,.05);
      border:1px solid var(--line);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .float{
      position:absolute;
      width:150px; height:150px;
      border-radius:40px;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      animation: bob 5.5s ease-in-out infinite;
    }
    .float.one{left:18px; top:18px}
    .float.two{right:18px; top:52px; animation-delay: -1.2s}
    .float.three{left:58px; bottom:18px; animation-delay: -2.1s}
    @keyframes bob{0%,100%{transform: translateY(0)}50%{transform: translateY(-10px)}}

    .kpi{
      position:absolute; right:16px; bottom:14px;
      padding:12px 14px;
      border-radius:18px;
      border:1px solid rgba(212,175,55,.45);
      background: rgba(0,0,0,.22);
      max-width: 70%;
    }
    .kpi b{color: var(--cream)}
    .spark{
      display:inline-block;
      width:8px; height:8px; border-radius:999px;
      background: var(--gold);
      box-shadow: 0 0 18px rgba(212,175,55,.8);
      margin-right:8px;
    }

    .appShell{
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:16px;
      margin-top:16px;
    }
    @media (max-width: 980px){ .appShell{grid-template-columns:1fr} }
    .side{position:sticky; top:86px; height: fit-content; padding:14px}
    .side h4{margin:0 0 8px}
    .side a{
      display:flex; gap:10px; align-items:center;
      padding:10px 12px; border-radius:14px;
      border:1px solid transparent;
      color: var(--muted);
    }
    .side a:hover{border-color: var(--line); color: var(--txt)}
    .side a.active{
      border-color: rgba(231,167,182,.55);
      background: rgba(231,167,182,.10);
      color: var(--txt);
    }

    input, textarea{
      width:100%;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.18);
      color: var(--txt);
      padding:10px 12px;
      outline:none;
    }
    textarea{min-height:120px; resize:vertical}
    .row{display:grid; grid-template-columns: 1fr 1fr; gap:12px}
    @media (max-width: 980px){ .row{grid-template-columns:1fr} }

    .toast{
      position: fixed; right: 16px; bottom: 16px;
      background: rgba(0,0,0,.7);
      border:1px solid rgba(255,255,255,.16);
      padding:12px 14px;
      border-radius:16px;
      color: var(--cream);
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
      opacity:0; transform: translateY(8px);
      pointer-events:none;
      transition: .18s ease;
      max-width: 360px;
      z-index: 999;
    }
    .toast.show{opacity:1; transform: translateY(0)}

    .lock{
      margin-top:10px;
      padding:10px 12px;
      border-radius:16px;
      border:1px solid rgba(212,175,55,.35);
      background: rgba(212,175,55,.08);
      color: var(--cream);
      font-size:13px;
      display:flex;
      gap:8px;
      align-items:center;
    }

    /* IMPORTANT: always show Login button nicely */
    .nav .loginBtn {
      border-color: rgba(231,167,182,.55) !important;
      background: rgba(231,167,182,.10) !important;
      color: var(--txt) !important;
      font-weight: 850;
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="inner">
      <div class="brand" id="brandHome" title="Go Home">
        HustlerHer Social Suite <span class="badge">Luxury Demo</span>
      </div>

      <nav class="nav" id="topNav">
        <a href="#/" data-route="#/">Home</a>
        <a href="#/pricing" data-route="#/pricing">Pricing</a>
        <a href="#/login" data-route="#/login" class="loginBtn">Login</a>
        <a href="#/affiliate" data-route="#/affiliate">Affiliate</a>
        <a href="#/app" data-route="#/app" class="btn small primary" style="padding:9px 12px">Open Dashboard</a>
      </nav>
    </div>
  </div>

  <div class="wrap" id="view"></div>
  <div class="toast" id="toast"></div>

  <script>
    // =============== STRIPE LINKS (paste later) ===============
    const STRIPE = {
      starter: "PASTE_STRIPE_LINK_STARTER",
      boss: "PASTE_STRIPE_LINK_BOSS",
      ceo: "PASTE_STRIPE_LINK_CEO"
    };

    // =============== USERS (demo only / no backend) ===============
    const AUTH = {
      owner:     { email: "owner@hustlerher.com",     pass: "HustleGold!39", role: "owner" },
      demo:      { email: "demo@hustlerher.com",      pass: "Demo123!",      role: "demo" },
      affiliate: { email: "affiliate@hustlerher.com", pass: "Aff123!",       role: "affiliate" }
    };

    // Demo dashboard = ONLY TWO features unlocked:
    // ‚úÖ Content Calendar + ‚úÖ Analytics Preview (Overview)
    const DEMO_ALLOWED_TABS = new Set(["overview","planner"]);

    // =============== helper functions ===============
    const $ = (s, el=document) => el.querySelector(s);
    const toast = (msg) => {
      const t = $("#toast");
      t.textContent = msg;
      t.classList.add("show");
      clearTimeout(toast._tm);
      toast._tm = setTimeout(() => t.classList.remove("show"), 2200);
    };

    const store = {
      get(k, fallback){ try{ return JSON.parse(localStorage.getItem(k)) ?? fallback; }catch{ return fallback; } },
      set(k, v){ localStorage.setItem(k, JSON.stringify(v)); }
    };

    function getSession(){ return store.get("hh.session", { role: "guest" }); }
    function setSession(role){ store.set("hh.session", { role, at: Date.now() }); }
    function logout(){ store.set("hh.session", { role:"guest" }); toast("Logged out."); location.hash="#/"; }

    function requireLoginForApp(){
      const s = getSession();
      if(s.role === "guest"){
        location.hash = "#/login";
        toast("Please login to open the dashboard.");
        return false;
      }
      if(s.role === "affiliate"){
        toast("Affiliate accounts access affiliate dashboard only.");
        location.hash = "#/affiliate-dashboard";
        return false;
      }
      return true;
    }

    // ===== Affiliate Tracking (local demo) =====
    (function captureAffiliateRef(){
      const url = new URL(location.href);
      const ref = url.searchParams.get("ref");
      if(ref){
        store.set("hh.referrer", ref);
        const clicks = store.get("hh.affClicks", {});
        clicks[ref] = (clicks[ref] || 0) + 1;
        store.set("hh.affClicks", clicks);
      }
    })();

    // =============== demo data ===============
    const state = {
      notes: store.get("hh.notes", ""),
      calendar: store.get("hh.calendar", [
        {id: crypto.randomUUID(), date:"2026-01-15", platform:"IG", title:"Reel: 3 hooks that sell"},
        {id: crypto.randomUUID(), date:"2026-01-16", platform:"TikTok", title:"Storytime: first $1k week"}
      ]),
      metrics: store.get("hh.metrics", { revenue: 1250, clicks: 860, leads: 42 }),

      // Owner Affiliate Sales view (mock numbers)
      affSales: store.get("hh.affSales", [
        {id: crypto.randomUUID(), name:"HH-214", plan:"Boss", amount:19, when:"2026-01-12"},
        {id: crypto.randomUUID(), name:"HH-109", plan:"CEO",  amount:39, when:"2026-01-13"},
        {id: crypto.randomUUID(), name:"HH-214", plan:"Starter", amount:7, when:"2026-01-14"}
      ])
    };

    const persistAll = () => {
      store.set("hh.notes", state.notes);
      store.set("hh.calendar", state.calendar);
      store.set("hh.metrics", state.metrics);
      store.set("hh.affSales", state.affSales);
    };

    // =============== router ===============
    function parseRoute(){
      const hash = location.hash || "#/";
      const [path, queryString] = hash.split("?");
      const qs = new URLSearchParams(queryString || "");
      return { path, qs };
    }

    function setActiveNav(path){
      document.querySelectorAll("#topNav a").forEach(a=>{
        const r = a.getAttribute("data-route");
        const active =
          (r === "#/" && path === "#/") ||
          (r === "#/pricing" && path === "#/pricing") ||
          (r === "#/login" && path === "#/login") ||
          (r === "#/affiliate" && path === "#/affiliate") ||
          (r === "#/app" && (path === "#/app" || path === "#/dashboard"));
        a.classList.toggle("active", active);
      });
    }

    // =============== views ===============
    function LandingView(){
      return `
        <section class="hero">
          <div class="card">
            <div class="pad">
              <div class="tiny" style="opacity:.9;margin-bottom:10px">
                Luxury planner energy ‚Ä¢ Social media execution
              </div>

              <h1 class="heroTitle">Plan your content. <span>Post like a CEO.</span><br/>Profit in heels.</h1>

              <p class="heroP">
                A luxury micro-SaaS inspired by a digital planner workflow: calendar, analytics, notes and more ‚Äî
                redesigned for women running marketing on Instagram, TikTok and Pinterest.
              </p>

              <div class="heroActions">
                <a class="btn primary" href="#/app">Launch Dashboard</a>
                <a class="btn rose" href="#/pricing">See Pricing</a>
                <a class="btn" href="#/login">Login</a>
              </div>

              <div class="lock">
                <span class="spark"></span>
                Demo dashboard shows <b>2 unlocked features</b> (Content Calendar + Analytics Preview). Owner has <b>full access</b>.
              </div>

              <div class="hr"></div>

              <div class="grid three">
                <div class="card"><div class="pad">
                  <h3>Content Calendar</h3>
                  <div class="muted">Plan posts by date + platform.</div>
                </div></div>

                <div class="card"><div class="pad">
                  <h3>Analytics Preview</h3>
                  <div class="muted">KPI snapshot that keeps you locked in.</div>
                </div></div>

                <div class="card"><div class="pad">
                  <h3>Premium Tools</h3>
                  <div class="muted">Locked for demo ‚Ä¢ Owner unlocks everything.</div>
                </div></div>
              </div>
            </div>
          </div>

          <div class="heroArt">
            <div class="float one"></div>
            <div class="float two"></div>
            <div class="float three"></div>
            <div class="kpi"><span class="spark"></span><b>Luxury UI</b> ‚Ä¢ blush / gold ‚Ä¢ GitHub Pages-ready</div>
          </div>
        </section>
      `;
    }

    function PricingView(){
      return `
        <div class="grid two">
          <div class="card">
            <div class="pad">
              <h2 style="margin:0 0 8px">Pricing</h2>
              <p class="muted" style="margin:0">Paste Stripe links once and your buttons will work.</p>
              <div class="hr"></div>

              <div class="card" style="background:rgba(0,0,0,.18); border-color:rgba(255,255,255,.16)">
                <div class="pad">
                  <div class="tiny"><b>Stripe Links</b> go at the top of this file:</div>
                  <pre style="margin:8px 0 0; white-space:pre-wrap; color:var(--cream); font-size:12px">const STRIPE = {
  starter: "PASTE_STRIPE_LINK_STARTER",
  boss: "PASTE_STRIPE_LINK_BOSS",
  ceo: "PASTE_STRIPE_LINK_CEO"
};</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="grid three" style="grid-column:1/-1">
            ${PricingCard("Starter", "$7", "Quick Start", ["Demo access (2 features)", "Content Calendar + Analytics Preview", "Basic templates"], "starter")}
            ${PricingCard("Boss", "$19", "Most Popular", ["Full access", "Premium tools", "Affiliate ready"], "boss", true)}
            ${PricingCard("CEO", "$39", "Owner-Level", ["Everything unlocked", "Affiliate sales view", "Export-ready"], "ceo")}
          </div>
        </div>
      `;
    }

    function PricingCard(name, price, tag, feats, key, featured=false){
      const glow = featured ? "border-color: rgba(212,175,55,.7); box-shadow: 0 18px 70px rgba(212,175,55,.12), var(--shadow);" : "";
      const btnClass = featured ? "btn primary" : "btn";
      return `
        <div class="card" style="${glow}">
          <div class="pad">
            <div style="display:flex; justify-content:space-between; align-items:center; gap:10px">
              <h3 style="margin:0">${name}</h3>
              <span class="badge">${tag}</span>
            </div>
            <div style="font-size:34px; font-weight:950; margin-top:6px">${price}<span class="tiny">/mo</span></div>
            <ul class="tiny" style="margin:12px 0 0; padding-left:16px; color:var(--muted)">
              ${feats.map(f=>`<li style="margin:6px 0">${f}</li>`).join("")}
            </ul>
            <div class="hr"></div>
            <button class="${btnClass}" data-buy="${key}" style="width:100%">Choose ${name}</button>
          </div>
        </div>
      `;
    }

    function LoginView(){
      return `
        <div class="grid two">
          <div class="card">
            <div class="pad">
              <h2 style="margin:0 0 8px">Login</h2>
              <p class="muted" style="margin:0">Owner unlocks everything. Buyer demo unlocks 2 features.</p>
              <div class="hr"></div>

              <label class="tiny">Email</label>
              <input id="loginEmail" placeholder="owner@hustlerher.com"/>

              <div style="height:10px"></div>

              <label class="tiny">Password</label>
              <input id="loginPass" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"/>

              <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
                <button class="btn primary" id="loginBtn">Login</button>
                <a class="btn" href="#/">Back</a>
              </div>

              <div class="hr"></div>

              <div class="tiny">
                <b>Owner:</b> owner@hustlerher.com / HustleGold!39<br/>
                <b>Buyer Demo:</b> demo@hustlerher.com / Demo123!
              </div>
            </div>
          </div>

          <div class="card">
            <div class="pad">
              <h3>Demo Access Includes</h3>
              <div class="muted">Unlocked:</div>
              <ul style="margin:10px 0 0; padding-left:16px; color:var(--muted)">
                <li>‚ú® Analytics Preview (Overview)</li>
                <li>üóì Content Calendar</li>
              </ul>
              <div class="hr"></div>
              <div class="muted">Owner Unlocks:</div>
              <ul style="margin:10px 0 0; padding-left:16px; color:var(--muted)">
                <li>üìá Brand/Client Hub</li>
                <li>üìù Notes + Hooks</li>
                <li>üí∞ Affiliate Sales</li>
                <li>Export / Import</li>
              </ul>
            </div>
          </div>
        </div>
      `;
    }

    function AffiliateView(){
      return `
        <div class="grid two">
          <div class="card">
            <div class="pad">
              <h2 style="margin:0 0 8px">Affiliate Login</h2>
              <p class="muted" style="margin:0">Get your referral link + track clicks & signups.</p>
              <div class="hr"></div>

              <label class="tiny">Affiliate Email</label>
              <input id="affEmail" placeholder="affiliate@hustlerher.com"/>

              <div style="height:10px"></div>

              <label class="tiny">Password</label>
              <input id="affPass" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"/>

              <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
                <button class="btn primary" id="affLoginBtn">Login</button>
                <a class="btn" href="#/">Back</a>
              </div>

              <div class="hr"></div>
              <div class="tiny">
                <b>Affiliate Demo:</b> affiliate@hustlerher.com / Aff123!
              </div>
            </div>
          </div>

          <div class="card">
            <div class="pad">
              <h3>Affiliate (Demo)</h3>
              <div class="muted">Track clicks & signups locally.</div>
              <div class="hr"></div>
              <div class="muted">Includes:</div>
              <ul style="margin:10px 0 0; padding-left:16px; color:var(--muted)">
                <li>Referral link generator</li>
                <li>Clicks + signups tracking</li>
                <li>Estimated commission</li>
              </ul>
            </div>
          </div>
        </div>
      `;
    }

    function AffiliateDashView(){
      const code = store.get("hh.affiliateCode", "HH-001");
      const clicks = store.get("hh.affClicks", {});
      const signups = store.get("hh.affSignups", {});
      const myClicks = clicks[code] || 0;
      const mySignups = signups[code] || 0;

      const base = location.origin + location.pathname;
      const refLink = `${base}?ref=${encodeURIComponent(code)}#/pricing`;
      const estCommission = (mySignups * 8.50).toFixed(2);

      return `
        <div class="card">
          <div class="pad">
            <h2 style="margin:0 0 6px">Affiliate Dashboard</h2>
            <div class="muted">Your referral code: <b style="color:var(--cream)">${code}</b></div>
            <div class="hr"></div>

            <div class="grid three">
              <div class="card"><div class="pad">
                <div class="tiny">Clicks</div>
                <div style="font-size:30px; font-weight:950">${myClicks}</div>
              </div></div>
              <div class="card"><div class="pad">
                <div class="tiny">Signups</div>
                <div style="font-size:30px; font-weight:950">${mySignups}</div>
              </div></div>
              <div class="card"><div class="pad">
                <div class="tiny">Est. Commission</div>
                <div style="font-size:30px; font-weight:950">$${estCommission}</div>
              </div></div>
            </div>

            <div class="hr"></div>

            <label class="tiny">Your Affiliate Link</label>
            <input id="affLink" value="${refLink}" readonly />

            <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
              <button class="btn primary" id="copyAff">Copy Link</button>
              <button class="btn rose" id="simulateSignup">Simulate Signup</button>
              <button class="btn dark" id="logoutAff">Logout</button>
            </div>
          </div>
        </div>
      `;
    }

    function LockedView(){
      return `
        <div class="card"><div class="pad">
          <h2 style="margin:0 0 8px">Locked Feature</h2>
          <p class="muted" style="margin:0 0 12px">This feature is locked in the demo dashboard.</p>
          <a class="btn primary" href="#/pricing">Upgrade Access</a>
        </div></div>
      `;
    }

    function AppView(qs){
      if(!requireLoginForApp()) return "";
      const session = getSession();
      const isOwner = session.role === "owner";
      let tab = qs.get("tab") || "overview";
      if(!isOwner && !DEMO_ALLOWED_TABS.has(tab)) tab = "overview";

      return `
        <div class="appShell">
          <div class="card side">
            <h4>Dashboard</h4>
            <div class="lock" style="margin-top:0">
              <span class="spark"></span>
              Mode: <b>${isOwner ? "Owner (Full Access)" : "Buyer Demo (2 Features)"}</b>
            </div>

            <div style="height:10px"></div>

            <a href="#/app?tab=overview" class="${tab==="overview"?"active":""}">‚ú® Analytics Preview</a>
            <a href="#/app?tab=planner" class="${tab==="planner"?"active":""}">üóì Content Calendar</a>

            <div class="hr"></div>

            <a href="#/app?tab=notes" class="${tab==="notes"?"active":""}">üìù Notes + Hooks</a>
            <a href="#/app?tab=clients" class="${tab==="clients"?"active":""}">üìá Brand/Client Hub</a>
            <a href="#/app?tab=affsales" class="${tab==="affsales"?"active":""}">üí∞ Affiliate Sales</a>

            <div class="hr"></div>
            <button class="btn dark" id="logoutBtn2" style="width:100%">Logout</button>
          </div>

          <div class="card">
            <div class="pad">
              ${AppTab(tab, isOwner)}
            </div>
          </div>
        </div>
      `;
    }

    function AppTab(tab, isOwner){
      if(tab==="overview"){
        return `
          <h2 style="margin:0 0 6px">Analytics Preview</h2>
          <div class="muted">Saved in browser ‚Ä¢ no backend.</div>
          <div class="hr"></div>

          <div class="grid three">
            <div class="card"><div class="pad">
              <div class="tiny">Revenue</div>
              <div style="font-size:30px; font-weight:950">$${state.metrics.revenue}</div>
            </div></div>
            <div class="card"><div class="pad">
              <div class="tiny">Clicks</div>
              <div style="font-size:30px; font-weight:950">${state.metrics.clicks}</div>
            </div></div>
            <div class="card"><div class="pad">
              <div class="tiny">Leads</div>
              <div style="font-size:30px; font-weight:950">${state.metrics.leads}</div>
            </div></div>
          </div>

          <div class="hr"></div>

          <label class="tiny">Quick Notes</label>
          <textarea id="notesBox" placeholder="Hooks, captions, offers...">${escapeHtml(state.notes)}</textarea>
          <div class="tiny" style="margin-top:8px">Auto-saved</div>
        `;
      }

      if(tab==="planner"){
        return `
          <h2 style="margin:0 0 6px">Content Calendar</h2>
          <div class="muted">Add posts to your schedule.</div>
          <div class="hr"></div>

          <div class="row">
            <div><label class="tiny">Date</label><input id="calDate" type="date"/></div>
            <div><label class="tiny">Platform</label><input id="calPlatform" placeholder="IG / TikTok / Pinterest"/></div>
          </div>
          <div style="margin-top:12px">
            <label class="tiny">Title</label>
            <input id="calTitle" placeholder="Reel: 3 hooks that sell"/>
          </div>
          <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
            <button class="btn primary" id="addCal">Add Post</button>
          </div>

          <div class="hr"></div>
          <div class="grid">
            ${state.calendar.map(item=>`
              <div class="card"><div class="pad" style="display:flex; justify-content:space-between; gap:10px; align-items:center">
                <div>
                  <b>${escapeHtml(item.date)}</b> ‚Ä¢ <span class="badge">${escapeHtml(item.platform)}</span>
                  <div class="muted" style="margin-top:6px">${escapeHtml(item.title)}</div>
                </div>
                <button class="btn" data-delcal="${item.id}">Remove</button>
              </div></div>
            `).join("")}
          </div>
        `;
      }

      // Owner-only tabs:
      if(!isOwner) return LockedView();

      if(tab==="notes"){
        return `
          <h2 style="margin:0 0 6px">Notes + Hooks (Owner)</h2>
          <div class="muted">Save scripts, hooks, CTA templates & offers.</div>
          <div class="hr"></div>
          <div class="tiny">Owner-only ‚úÖ (expand anytime)</div>
        `;
      }

      if(tab==="clients"){
        return `
          <h2 style="margin:0 0 6px">Brand/Client Hub (Owner)</h2>
          <div class="muted">Track collabs, affiliates, and brand deals.</div>
          <div class="hr"></div>
          <div class="tiny">Owner-only ‚úÖ (expand anytime)</div>
        `;
      }

      if(tab==="affsales"){
        const total = state.affSales.reduce((a,x)=>a + (Number(x.amount)||0), 0).toFixed(2);
        return `
          <h2 style="margin:0 0 6px">Affiliate Sales (Owner)</h2>
          <div class="muted">Mock sales report (ready for real backend later).</div>
          <div class="hr"></div>

          <div class="grid three">
            <div class="card"><div class="pad">
              <div class="tiny">Total Affiliate Revenue</div>
              <div style="font-size:30px; font-weight:950">$${total}</div>
            </div></div>
            <div class="card"><div class="pad">
              <div class="tiny">Orders</div>
              <div style="font-size:30px; font-weight:950">${state.affSales.length}</div>
            </div></div>
            <div class="card"><div class="pad">
              <div class="tiny">Top Referrer</div>
              <div style="font-size:18px; font-weight:950">${escapeHtml((state.affSales[0]?.name)||"HH-214")}</div>
              <div class="tiny">demo data</div>
            </div></div>
          </div>

          <div class="hr"></div>

          <div class="grid">
            ${state.affSales.map(s=>`
              <div class="card"><div class="pad" style="display:flex; justify-content:space-between; gap:12px; align-items:center">
                <div>
                  <b>${escapeHtml(s.name)}</b> ‚Ä¢ <span class="badge">${escapeHtml(s.plan)}</span>
                  <div class="tiny" style="margin-top:6px">${escapeHtml(s.when)}</div>
                </div>
                <div style="font-weight:950; font-size:18px">$${Number(s.amount).toFixed(2)}</div>
              </div></div>
            `).join("")}
          </div>
        `;
      }

      return `<div class="muted">Unknown tab.</div>`;
    }

    // =============== events ===============
    function bindHandlers(){
      // Brand click = home
      const brand = $("#brandHome");
      if(brand) brand.onclick = ()=> location.hash = "#/";

      // Stripe buy
      document.querySelectorAll("[data-buy]").forEach(btn=>{
        btn.onclick = ()=>{
          const key = btn.getAttribute("data-buy");
          const link = STRIPE[key];
          if(!link || link.startsWith("PASTE_")) return toast("Paste Stripe links first.");
          window.open(link, "_blank","noopener,noreferrer");
        };
      });

      // Login
      const loginBtn = $("#loginBtn");
      if(loginBtn){
        loginBtn.onclick = ()=>{
          const email = ($("#loginEmail").value||"").trim().toLowerCase();
          const pass  = ($("#loginPass").value||"").trim();

          if(email===AUTH.owner.email && pass===AUTH.owner.pass){
            setSession("owner"); toast("Owner login ‚úÖ"); location.hash="#/app"; return;
          }
          if(email===AUTH.demo.email && pass===AUTH.demo.pass){
            setSession("demo"); toast("Buyer demo login ‚ú®"); location.hash="#/app"; return;
          }
          toast("Invalid login.");
        };
      }

      // Affiliate Login
      const affLoginBtn = $("#affLoginBtn");
      if(affLoginBtn){
        affLoginBtn.onclick = ()=>{
          const email = ($("#affEmail").value||"").trim().toLowerCase();
          const pass  = ($("#affPass").value||"").trim();
          if(email===AUTH.affiliate.email && pass===AUTH.affiliate.pass){
            setSession("affiliate");
            if(!store.get("hh.affiliateCode", "")){
              const newCode = "HH-" + String(Math.floor(100 + Math.random()*900));
              store.set("hh.affiliateCode", newCode);
            }
            toast("Affiliate login ‚úÖ");
            location.hash = "#/affiliate-dashboard";
            return;
          }
          toast("Invalid affiliate login.");
        };
      }

      // Affiliate Dashboard
      const copyAff = $("#copyAff");
      if(copyAff){
        copyAff.onclick = async ()=>{
          const link = $("#affLink").value;
          try{ await navigator.clipboard.writeText(link); toast("Affiliate link copied."); }
          catch{ toast("Copy failed. Select link and copy manually."); }
        };
      }

      const simulateSignup = $("#simulateSignup");
      if(simulateSignup){
        simulateSignup.onclick = ()=>{
          const code = store.get("hh.affiliateCode","HH-001");
          const signups = store.get("hh.affSignups", {});
          signups[code] = (signups[code] || 0) + 1;
          store.set("hh.affSignups", signups);

          // also simulate an affiliate sale
          state.affSales.unshift({
            id: crypto.randomUUID(),
            name: code,
            plan: ["Starter","Boss","CEO"][Math.floor(Math.random()*3)],
            amount: [7,19,39][Math.floor(Math.random()*3)],
            when: new Date().toISOString().slice(0,10)
          });
          persistAll();
          toast("Simulated signup + sale ‚úÖ");
          render();
        };
      }

      const logoutAff = $("#logoutAff");
      if(logoutAff) logoutAff.onclick = logout;

      const logoutBtn2 = $("#logoutBtn2");
      if(logoutBtn2) logoutBtn2.onclick = logout;

      // notes autosave
      document.querySelectorAll("#notesBox").forEach(el=>{
        el.oninput = ()=>{ state.notes = el.value; persistAll(); };
      });

      // planner add/remove
      const addCal = $("#addCal");
      if(addCal){
        addCal.onclick = ()=>{
          const date = $("#calDate").value;
          const platform = ($("#calPlatform").value||"").trim();
          const title = ($("#calTitle").value||"").trim();
          if(!date||!platform||!title) return toast("Add date, platform, title.");
          state.calendar.unshift({id: crypto.randomUUID(), date, platform, title});
          persistAll(); toast("Post added."); render();
        };
      }
      document.querySelectorAll("[data-delcal]").forEach(b=>{
        b.onclick = ()=>{
          const id = b.getAttribute("data-delcal");
          state.calendar = state.calendar.filter(x=>x.id!==id);
          persistAll(); render();
        };
      });
    }

    // =============== render ===============
    function render(){
      const { path, qs } = parseRoute();
      const normalized = (path === "#/dashboard") ? "#/app" : path;
      setActiveNav(normalized);

      const view = $("#view");
      if(normalized === "#/") view.innerHTML = LandingView();
      else if(normalized === "#/pricing") view.innerHTML = PricingView();
      else if(normalized === "#/login") view.innerHTML = LoginView();
      else if(normalized === "#/affiliate") view.innerHTML = AffiliateView();
      else if(normalized === "#/affiliate-dashboard"){
        const s = getSession();
        if(s.role !== "affiliate"){ toast("Affiliate login required."); location.hash="#/affiliate"; return; }
        view.innerHTML = AffiliateDashView();
      }
      else if(normalized === "#/app") view.innerHTML = AppView(qs);
      else view.innerHTML = `<div class="card"><div class="pad"><h2>Not found</h2><a class="btn primary" href="#/">Go Home</a></div></div>`;

      bindHandlers();
    }

    function escapeHtml(str){
      return (str ?? "").replace(/[&<>"']/g, m => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[m]));
    }

    window.addEventListener("hashchange", render);
    window.addEventListener("load", ()=>{
      if(!location.hash) location.hash="#/";
      render();
    });
  </script>
</body>
</html>
